spring:
  application:
    name: archiver-backend

  datasource:
    url: jdbc:postgresql://localhost:5432/archiver?stringtype=unspecified
    username: archiver
    password: archiver
    hikari:
      maximum-pool-size: 20

  flyway:
    enabled: true
    locations: classpath:db/migration

  servlet:
    multipart:
      max-file-size: 200MB
      max-request-size: 200MB

server:
  port: 8080

spring.ai.mcp.server:
  name: archiver
  version: "1.0.0"
  type: SYNC
  protocol: SSE
  sse-endpoint: /api/mcp/sse
  sse-message-endpoint: /api/mcp/message

springdoc:
  api-docs:
    path: /api-docs
  swagger-ui:
    path: /swagger-ui.html

archiver:
  storage:
    root: ${ARCHIVER_STORAGE_ROOT:/tmp/archiver-storage}
  processor:
    token: ${ARCHIVER_PROCESSOR_TOKEN:dev-processor-token}
  openai:
    api-key: ${OPENAI_API_KEY:}
  translate-worker:
    url: ${TRANSLATE_WORKER_URL:http://translate-worker:8001}
  anthropic:
    api-key: ${ANTHROPIC_API_KEY:}

management:
  endpoints:
    web:
      exposure:
        include: health,info,metrics

---
spring:
  config:
    activate:
      on-profile: dev

  datasource:
    url: jdbc:postgresql://localhost:5432/archiver_dev?stringtype=unspecified
    username: archiver
    password: archiver

---
spring:
  config:
    activate:
      on-profile: prod

  datasource:
    url: ${DATASOURCE_URL}
    username: ${DATASOURCE_USERNAME}
    password: ${DATASOURCE_PASSWORD}
    hikari:
      maximum-pool-size: ${DATASOURCE_POOL_SIZE:30}

---
spring:
  config:
    activate:
      on-profile: test

  datasource:
    url: jdbc:postgresql://localhost:5432/archiver_test?stringtype=unspecified
    username: archiver
    password: archiver

  flyway:
    clean-disabled: false
